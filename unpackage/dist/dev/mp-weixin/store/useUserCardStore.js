"use strict";const s=require("../common/vendor.js"),T=require("../api/user.js"),C=require("./useCartStore.js"),h=s.defineStore("user-card",()=>{const o=C.useCartStore(),t=s.ref([]),n=s.ref(""),u=s.ref([]),a=async e=>{const c=await T.getUserInfoAPI(e);n.value=c.balance,t.value=c.tickets,u.value=c.card,t.value.length&&t.value.forEach(r=>r.selected=!1)},d=e=>{n.value.num=e},f=e=>{if(!t.value.length)return;let c=t.value.filter(i=>i.ticket_condition<=e).reduce((i,l)=>(l.ticket_price>i.ticket_price&&(i.ticket_id=l.ticket_id,i.ticket_price=l.ticket_price),i),{ticket_id:0,ticket_price:0});return t.value.find(i=>i.ticket_id==c.ticket_id)},k=(e,c="else")=>{const r=f(e);if(c=="price")return r?r.ticket_price:0;if(c=="selected")r&&(r.selected=!0);else return r},_=e=>{t.value.forEach(c=>{c.selected=!1,c.ticket_id===e.ticket_id&&(c.selected=!0)})},v=()=>{t.value.forEach(e=>e.selected=!1)},p=s.computed(()=>t.value.find(e=>e.selected)),m=s.computed(()=>t.value.filter(e=>e.ticket_condition<o.allRetailPrice)),S=s.computed(()=>t.value.filter(e=>e.ticket_condition>o.allRetailPrice));return{userBalance:n,userTicketList:t,userCard:u,getUserCardInfo:a,selectedTicket:p,optimalTicket:k,effectiveTickets:m,uselessTickets:S,tapSelected:_,unUseTicket:v,postNewBalance:d}});exports.useUserCardStore=h;
