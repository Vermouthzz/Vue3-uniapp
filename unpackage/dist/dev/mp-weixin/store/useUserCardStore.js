"use strict";const s=require("../common/vendor.js"),S=require("../api/user.js"),T=require("./useCartStore.js"),g=s.defineStore("user-card",()=>{const o=T.useCartStore(),c=s.ref([]),l=s.ref(""),n=s.ref([]),u=async e=>{const t=await S.getUserInfoAPI();l.value=t.balance,c.value=t.tickets,n.value=t.card.map(i=>Object.assign(i,{checked:!1})),c.value.length&&c.value.forEach(i=>i.selected=!1)},d=e=>{l.value.num=e},f=(e,t)=>{t=="li"?n.value[0].checked=e:n.value[1].checked=e},k=e=>{if(!c.value.length)return;let t=c.value.filter(r=>r.ticket_condition<=e).reduce((r,a)=>(a.ticket_price>r.ticket_price&&(r.ticket_id=a.ticket_id,r.ticket_price=a.ticket_price),r),{ticket_id:0,ticket_price:0});return c.value.find(r=>r.ticket_id==t.ticket_id)},_=(e,t="else")=>{const i=k(e);if(t=="price")return i?i.ticket_price:0;if(t=="selected")i&&(i.selected=!0);else return i},v=e=>{c.value.forEach(t=>{t.selected=!1,t.ticket_id===e.ticket_id&&(t.selected=!0)})},p=()=>{c.value.forEach(e=>e.selected=!1)},h=s.computed(()=>c.value.find(e=>e.selected)),m=s.computed(()=>c.value.filter(e=>e.ticket_condition<o.allRetailPrice)),C=s.computed(()=>c.value.filter(e=>e.ticket_condition>o.allRetailPrice));return{userBalance:l,userTicketList:c,userCard:n,getUserCardInfo:u,selectedTicket:h,optimalTicket:_,effectiveTickets:m,uselessTickets:C,tapSelected:v,unUseTicket:p,postNewBalance:d,onCheckedChange:f}});exports.useUserCardStore=g;
