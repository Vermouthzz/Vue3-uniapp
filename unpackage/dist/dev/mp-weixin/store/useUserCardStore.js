"use strict";const s=require("../common/vendor.js"),S=require("../api/user.js"),T=require("./useCartStore.js"),C=s.defineStore("user-card",()=>{const l=T.useCartStore(),t=s.ref([]),o=s.ref(""),u=s.ref([]),a=async e=>{const c=await S.getUserInfoAPI(e);o.value=c.balance,t.value=c.tickets,u.value=c.card,t.value.length&&t.value.forEach(r=>r.selected=!1)},d=e=>{if(!t.value.length)return;let c=t.value.filter(i=>i.ticket_condition<=e).reduce((i,n)=>(n.ticket_price>i.ticket_price&&(i.ticket_id=n.ticket_id,i.ticket_price=n.ticket_price),i),{ticket_id:0,ticket_price:0});return t.value.find(i=>i.ticket_id==c.ticket_id)},f=(e,c="else")=>{const r=d(e);if(c=="price")return r?r.ticket_price:0;if(c=="selected")r&&(r.selected=!0);else return r},k=e=>{t.value.forEach(c=>{c.selected=!1,c.ticket_id===e.ticket_id&&(c.selected=!0)})},_=()=>{t.value.forEach(e=>e.selected=!1)},v=s.computed(()=>t.value.find(e=>e.selected)),p=s.computed(()=>t.value.filter(e=>e.ticket_condition<l.allRetailPrice)),m=s.computed(()=>t.value.filter(e=>e.ticket_condition>l.allRetailPrice));return{userBalance:o,userTicketList:t,userCard:u,getUserCardInfo:a,selectedTicket:v,optimalTicket:f,effectiveTickets:p,uselessTickets:m,tapSelected:k,unUseTicket:_}});exports.useUserCardStore=C;
