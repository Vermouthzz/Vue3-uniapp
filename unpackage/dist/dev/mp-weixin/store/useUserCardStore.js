"use strict";const s=require("../common/vendor.js"),m=require("../api/user.js"),S=require("./useCartStore.js"),C=s.defineStore("user-card",()=>{const l=S.useCartStore(),c=s.ref([]),o=s.ref(""),u=s.ref([]),a=async e=>{const t=await m.getUserInfoAPI(e);o.value=t.balance,c.value=t.tickets,u.value=t.card,c.value.length&&c.value.forEach(r=>r.selected=!1)},d=e=>{if(!c.value.length)return;let t=c.value.filter(i=>i.ticket_condition<=e).reduce((i,n)=>(n.ticket_price>i.ticket_price&&(i.ticket_id=n.ticket_id,i.ticket_price=n.ticket_price),i),{ticket_id:0,ticket_price:0});return c.value.find(i=>i.ticket_id==t.ticket_id)},f=(e,t="else")=>{const r=d(e);if(t=="price")return r?r.ticket_price:0;if(t=="selected")r&&(r.selected=!0);else return r},k=e=>{c.value.forEach(t=>{t.selected=!1,t.ticket_id===e.ticket_id&&(t.selected=!0)})},_=s.computed(()=>c.value.find(e=>e.selected)),v=s.computed(()=>c.value.filter(e=>e.ticket_condition<l.allRetailPrice)),p=s.computed(()=>c.value.filter(e=>e.ticket_condition>l.allRetailPrice));return{userBalance:o,userTicketList:c,userCard:u,getUserCardInfo:a,selectedTicket:_,optimalTicket:f,effectiveTickets:v,uselessTickets:p,tapSelected:k}});exports.useUserCardStore=C;
